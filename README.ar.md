# benf

أداة CLI لاكتشاف الشذوذ باستخدام قانون بنفورد مع دعم الأرقام الدولية (اليابانية، الصينية، الهندية، العربية).

## نظرة عامة

`benf` يحلل البيانات الرقمية للتحقق من اتباعها لقانون بنفورد، الذي ينص على أنه في العديد من مجموعات البيانات الطبيعية، يظهر الرقم 1 كـ**الرقم الأول (الرقم الرائد)** حوالي 30.1% من الوقت، و2 يظهر 17.6% من الوقت، وهكذا. الانحرافات عن هذا القانون قد تشير إلى تلاعب في البيانات أو احتيال.

**ملاحظة**: تحلل هذه الأداة فقط **الرقم الأول** من كل عدد، وليس تسلسل الأرقام بالكامل.

**الميزات الفريدة:**
- 🌍 **دعم الأرقام الدولية**: الإنجليزية، اليابانية (全角・漢数字)، الصينية (中文数字)، الهندية (हिन्दी अंक)، العربية (الأرقام العربية)
- 📊 تنسيقات إدخال متعددة (Microsoft Excel، Word، PowerPoint، PDF، إلخ)
- 🌐 تحليل URL مباشر مع تحليل HTML
- 🔍 التركيز على اكتشاف الاحتيال مع مؤشرات مستوى المخاطر

## دعم الأرقام الدولية

### تنسيقات الأرقام المدعومة

#### 1. الأرقام كاملة العرض
```bash
echo "１２３４５６ ７８９０１２" | benf
```

#### 2. أرقام الكانجي (أساسية)
```bash
echo "一二三四五六七八九" | benf
```

#### 3. أرقام الكانجي (موضعية)
```bash
echo "一千二百三十四 五千六百七十八 九万一千二百" | benf
```

#### 4. أنماط مختلطة
```bash
echo "مبيعات123万円 مصاريف45万6千円 ربح78万９千円" | benf
```

### قواعد التحويل

| كانجي | رقم | ملاحظات |
|-------|-----|---------|
| 一 | 1 | رقم أساسي |
| 十 | 10 | مكان العشرات |
| 百 | 100 | مكان المئات |
| 千 | 1000 | مكان الآلاف |
| 万 | 10000 | مكان عشرات الآلاف |
| 一千二百三十四 | 1234 | التدوين الموضعي |

#### الأرقام العشرية
```bash
# يتم تحليل الأرقام ≥ 1 فقط
echo "12.34 0.567 123.45" | benf
# النتيجة: 1، (مستثناة)، 1 (الأرقام < 1 مستثناة)
```

#### الأرقام السالبة
```bash
# يستخدم الرقم الأول للقيمة المطلقة
echo "-123 -456 -789" | benf
# النتيجة: 1، 4، 7
```

### توافق الأرقام الصينية

التنفيذ الحالي يدعم الأرقام الصينية الأساسية المتطابقة مع الكانجي الياباني:

#### مدعوم (الأشكال الأساسية)
- 一二三四五六七八九 (1-9) - نفس اليابانية
- 十百千 (10، 100، 1000) - علامات موضعية

#### الدعم المخطط
- **الأشكال المالية**: 壹貳參肆伍陸柒捌玖 (متغيرات مضادة للاحتيال)
- **التقليدية**: 萬 (10,000) مقابل اليابانية 万
- **المتغيرات الإقليمية**: الصينية التقليدية مقابل المبسطة

### الأرقام الهندية (हिन्दी अंक)
```bash
# أرقام ديوناغاري
echo "१२३४५६ ७८९०१२" | benf --lang hi
```

### الأرقام العربية (الأرقام العربية)
```bash  
# الأرقام العربية-الهندية الشرقية
echo "١٢٣٤٥٦ ٧٨٩٠١٢" | benf --lang ar
```

### أنظمة الأرقام الأخرى (الدعم المستقبلي)

#### النصوص الإضافية (مخططة)
- **الفارسية**: ۰۱۲۳۴۵۶۷۸۹ (إيران، أفغانستان)
- **البنغالية**: ০১২৩৪৫৬৭৮৯ (بنغلاديش)
- **التاميلية**: ௦௧௨௩௪௫௬௭௮௯ (تاميل نادو)
- **التايلاندية**: ๐๑๒๓๔๕๖๗๘๙ (تايلاند)
- **الميانمارية**: ၀၁၂၃၄၅၆၇၈၉ (ميانمار)

> **ملاحظة**: دعم الأرقام الدولية يستمر في التوسع بناءً على طلب المستخدمين. الأولوية الحالية: تحليل الوثائق المالية اليابانية/الصينية/الهندية/العربية.

## التثبيت

### البناء من المصدر
```bash
git clone https://github.com/kako-jun/benf
cd benf
cargo build --release
cp target/release/benf /usr/local/bin/
```

### إصدارات ثنائية
تحميل من [صفحة الإصدارات](https://github.com/kako-jun/benf/releases)

## البداية السريعة

```bash
# تحليل ملف CSV
benf data.csv

# تحليل بيانات الموقع
benf --url https://example.com/financial-report

# بيانات الأنبوب
echo "123 456 789 101112" | benf

# إخراج JSON للأتمتة
benf data.csv --format json
```

## الاستخدام

### الصيغة الأساسية
```bash
benf [OPTIONS] [INPUT]
```

### طرق الإدخال
1. **مسار الملف**: `benf financial_data.xlsx`
2. **URL**: `benf --url https://api.example.com/data`
3. **نص**: `benf "123 456 789 101112"`
4. **أنبوب**: `cat data.txt | benf`

الأولوية: URL > ملف > نص > أنبوب

### الخيارات

| خيار | وصف |
|------|------|
| `--url <URL>` | جلب البيانات من URL |
| `--format <FORMAT>` | تنسيق الإخراج: text, csv, json, yaml, toml, xml |
| `--quiet` | إخراج أدنى (أرقام فقط) |
| `--verbose` | إحصائيات مفصلة |
| `--lang <LANGUAGE>` | لغة الإخراج: en, ja, zh, hi, ar (افتراضي: auto) |
| `--filter <RANGE>` | تصفية الأرقام (مثال: `--filter ">=100"`) |
| `--threshold <LEVEL>` | عتبة التنبيه: low, medium, high, critical |
| `--proxy <URL>` | خادم بروكسي HTTP |
| `--insecure` | تخطي التحقق من شهادة SSL |
| `--timeout <SECONDS>` | مهلة الطلب (افتراضي: 30) |
| `--log-level <LEVEL>` | مستوى السجل: debug, info, warn, error |
| `--help, -h` | عرض المساعدة |
| `--version, -V` | عرض الإصدار |

### تنسيقات الملفات المدعومة

| تنسيق | امتدادات | ملاحظات |
|--------|----------|---------|
| Microsoft Excel | .xlsx, .xls | بيانات جداول البيانات |
| Microsoft Word | .docx, .doc | تحليل الوثائق |
| Microsoft PowerPoint | .pptx, .ppt | بيانات العروض التقديمية |
| OpenDocument | ods, .odt | ملفات OpenOffice/LibreOffice |
| PDF | .pdf | استخراج النص |
| CSV/TSV | .csv, .tsv | بيانات منظمة |
| JSON/XML | .json, .xml | استجابات API |
| YAML/TOML | .yaml, .toml | ملفات التكوين |
| HTML | .html | صفحات الويب |
| نص | .txt | نص عادي |

## الإخراج

### الإخراج الافتراضي
```
نتائج تحليل قانون بنفورد

مجموعة البيانات: financial_data.csv
الأرقام المحللة: 1,247
مستوى المخاطر: عالي ⚠️

توزيع الرقم الأول:
1: ████████████████████████████ 28.3% (متوقع: 30.1%)
2: ████████████████████ 20.1% (متوقع: 17.6%)
3: ██████████ 9.8% (متوقع: 12.5%)
...

الاختبارات الإحصائية:
كاي تربيع: 23.45 (القيمة الاحتمالية: 0.003)
متوسط الانحراف المطلق: 2.1%

الحكم: تم اكتشاف انحراف كبير
```

### إخراج JSON
```json
{
  "dataset": "financial_data.csv",
  "numbers_analyzed": 1247,
  "risk_level": "HIGH",
  "digits": {
    "1": {"observed": 28.3, "expected": 30.1, "deviation": -1.8},
    "2": {"observed": 20.1, "expected": 17.6, "deviation": 2.5}
  },
  "statistics": {
    "chi_square": 23.45,
    "p_value": 0.003,
    "mad": 2.1
  },
  "verdict": "SIGNIFICANT_DEVIATION"
}
```

## أمثلة

### اكتشاف الاحتيال
```bash
# مراقبة بيانات المبيعات
benf sales_report.xlsx --threshold high

# مراقبة السجلات في الوقت الفعلي
tail -f transactions.log | benf --format json | jq 'select(.risk_level == "HIGH")'

# تحليل دفعي
find . -name "*.csv" -exec benf {} \; | grep "HIGH"
```

### الأرقام العربية
```bash
# الأرقام العربية-الهندية
echo "١٢٣ ٤٥٦ ٧٨٩" | benf

# أنماط مختلطة
benf arabic_financial_report.pdf
```

### تحليل الويب
```bash
# موقع مالي
benf --url https://company.com/earnings --format json

# نقطة نهاية API
benf --url https://api.finance.com/data --proxy http://proxy:8080
```

### الأتمتة
```bash
# فحص الاحتيال اليومي
#!/bin/bash
RESULT=$(benf daily_sales.csv --format json)
RISK=$(echo $RESULT | jq -r '.risk_level')
if [ "$RISK" = "HIGH" ]; then
    echo $RESULT | mail -s "تنبيه احتيال" admin@company.com
fi
```

## مستويات المخاطر

| مستوى | قيمة كاي تربيع p | التفسير |
|-------|------------------|----------|
| منخفض | p > 0.1 | توزيع طبيعي |
| متوسط | 0.05 < p ≤ 0.1 | انحراف طفيف |
| عالي | 0.01 < p ≤ 0.05 | انحراف كبير |
| حرج | p ≤ 0.01 | دليل قوي على التلاعب |

## حالات الاستخدام الشائعة

- **تدقيق المحاسبة**: كشف السجلات المالية المُلاعب بها
- **التحقيقات الضريبية**: تحديد إقرارات الدخل المشبوهة
- **مراقبة الانتخابات**: التحقق من صحة عد الأصوات
- **مطالبات التأمين**: اكتشاف أنماط المطالبات الاحتيالية
- **البيانات العلمية**: التحقق من نتائج البحث
- **مراقبة الجودة**: مراقبة بيانات التصنيع

## ⚠️ قيود مهمة

**قانون بنفورد لا ينطبق على:**
- **النطاقات المقيدة**: طول البالغين (1.5-2.0م)، العمر (0-100)، درجة الحرارة
- **البيانات المتسلسلة**: أرقام الفواتير، معرفات الموظفين، الرموز البريدية
- **الأرقام المُعيَّنة**: أرقام الهاتف، أرقام الضمان الاجتماعي، أرقام اليانصيب
- **مجموعات البيانات الصغيرة**: أقل من 30-50 رقم (غير كافية للتحليل الإحصائي)
- **بيانات مصدر واحد**: من نفس العملية/الآلة بأحجام متشابهة
- **البيانات المدورة**: مبالغ مدورة بشدة (مثل، تنتهي جميعها بـ 00)

**الأنسب لـ:**
- **بيانات طبيعية متعددة المقاييس**: المعاملات المالية، السكان، القياسات الفيزيائية
- **مصادر متنوعة**: بيانات مختلطة من عمليات/إطارات زمنية مختلفة
- **مجموعات بيانات كبيرة**: 100+ رقم للتحليل الموثوق
- **بيانات غير مُلاعب بها**: طبيعية، غير مقيدة اصطناعياً

## الخلفية التاريخية

**الاكتشاف والتطوير:**
- **1881**: سيمون نيوكومب لاحظ الظاهرة لأول مرة أثناء دراسة جداول اللوغاريتم
- **1938**: الفيزيائي فرانك بنفورد أعاد اكتشاف وإضفاء الطابع الرسمي على القانون من خلال بحث شامل
- **1972**: أول تطبيق في الأدبيات الأكاديمية للمحاسبة واكتشاف الاحتيال
- **الثمانينيات**: بدأت شركات المحاسبة الكبرى في استخدام قانون بنفورد كأداة تدقيق قياسية
- **التسعينيات**: مارك نيغريني شعبى استخدامه في المحاسبة الجنائية واكتشاف الاحتيال الضريبي
- **الألفية الثانية+**: توسع إلى مراقبة الانتخابات، التحقق من البيانات العلمية، والتحقيق في الجرائم المالية

**التطبيقات الحديثة:**
- تستخدمه مصلحة الضرائب الأمريكية لفرز التدقيق الضريبي
- أداة قياسية في شركات المحاسبة الأربع الكبرى
- تطبق في اكتشاف احتيال الانتخابات (خاصة تحليل انتخابات إيران 2009)
- توظف في تحقيقات مكافحة غسل الأموال

## رموز الخروج

| رمز | المعنى |
|-----|-------|
| 0 | نجح |
| 1 | خطأ عام |
| 2 | معاملات غير صحيحة |
| 3 | خطأ ملف/شبكة |
| 10 | تم اكتشاف مخاطر عالية |
| 11 | تم اكتشاف مخاطر حرجة |

## التكوين

Benf يحترم متغيرات البيئة القياسية:
- `HTTP_PROXY` / `HTTPS_PROXY`: إعدادات البروكسي
- `NO_PROXY`: قائمة تجاوز البروكسي

السجلات تُكتب إلى:
- Linux: `~/.local/state/benf/`
- macOS: `~/Library/Logs/benf/`
- Windows: `%APPDATA%\benf\Logs\`

## المساهمة

انظر [CONTRIBUTING.md](CONTRIBUTING.md) لإرشادات التطوير.

## الترخيص

ترخيص MIT - انظر ملف [LICENSE](LICENSE).

## المراجع

- [قانون بنفورد - ويكيبيديا](https://ar.wikipedia.org/wiki/قانون_بنفورد)
- [استخدام قانون بنفورد لاكتشاف الاحتيال](https://example.com/benford-fraud)